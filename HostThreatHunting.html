<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><style>body {
  max-width: 980px;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 45px;
}

@font-face {
  font-family: fontawesome-mini;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body b,
.markdown-body strong {
  font-weight: bold;
}

.markdown-body mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
.markdown-body sup {
  top: -0.5em;
}
.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body .codehilitetable,
.markdown-body .highlighttable {
  border: 0;
  border-spacing: 0;
}

.markdown-body .codehilitetable tr,
.markdown-body .highlighttable {
  border: 0;
}

.markdown-body .codehilitetable pre,
.markdown-body .codehilitetable div.codehilite,
.markdown-body .highlighttable pre,
.markdown-body .highlighttable div.highlight {
  margin: 0;
}

.markdown-body .linenos,
.markdown-body .code,
.markdown-body .codehilitetable td,
.markdown-body .highlighttable td {
  border: 0;
  padding: 0;
}

.markdown-body td:not(.linenos) .linenodiv {
  padding: 0 !important;
}

.markdown-body .code {
  width: 100%;
}

.markdown-body .linenos div pre,
.markdown-body .linenodiv pre,
.markdown-body .linenodiv {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-left-radius: 3px;
  -webkit-border-bottom-left-radius: 3px;
  -moz-border-radius-topleft: 3px;
  -moz-border-radius-bottomleft: 3px;
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}

.markdown-body .code div pre,
.markdown-body .code div {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-right-radius: 3px;
  -webkit-border-bottom-right-radius: 3px;
  -moz-border-radius-topright: 3px;
  -moz-border-radius-bottomright: 3px;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
  line-height: 1.4;
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before,
.markdown-body hr:after {
  display: table;
  content: " ";
}

.markdown-body hr:after {
  clear: both;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre,
.markdown-body samp {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -moz-linear-gradient(#fefefe, #e7e7e7);
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  border-radius: 2px;
  border: 1px solid #cfcfcf;
  color: #000;
  padding: 3px 5px;
  line-height: 10px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  display: inline-block;
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .headerlink {
  font: normal 400 16px fontawesome-mini;
  vertical-align: middle;
  margin-left: -16px;
  float: left;
  display: inline-block;
  text-decoration: none;
  opacity: 0;
  color: #333;
}

.markdown-body .headerlink:focus {
  outline: none;
}

.markdown-body h1 .headerlink {
  margin-top: 0.8rem;
}

.markdown-body h2 .headerlink,
.markdown-body h3 .headerlink {
  margin-top: 0.6rem;
}

.markdown-body h4 .headerlink {
  margin-top: 0.2rem;
}

.markdown-body h5 .headerlink,
.markdown-body h6 .headerlink {
  margin-top: 0;
}

.markdown-body .headerlink:hover,
.markdown-body h1:hover .headerlink,
.markdown-body h2:hover .headerlink,
.markdown-body h3:hover .headerlink,
.markdown-body h4:hover .headerlink,
.markdown-body h5:hover .headerlink,
.markdown-body h6:hover .headerlink {
  opacity: 1;
  text-decoration: none;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body .admonition {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code,
.markdown-body samp {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  border-radius: 3px;
}

.markdown-body code:not(.highlight):not(.codehilite), .markdown-body samp {
  background-color: rgba(0,0,0,0.04);
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .codehilite,
.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .codehilite pre,
.markdown-body .highlight pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
}

.markdown-body .codehilite,
.markdown-body .highlight,
.markdown-body pre {
  border-radius: 3px;
}

.markdown-body :not(.highlight) > pre {
  background-color: #f7f7f7;
}

.markdown-body .codehilite pre,
.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

/* Admonition */
.markdown-body .admonition {
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  position: relative;
  border-radius: 3px;
  border: 1px solid #e0e0e0;
  border-left: 6px solid #333;
  padding: 10px 10px 10px 30px;
}

.markdown-body .admonition table {
  color: #333;
}

.markdown-body .admonition p {
  padding: 0;
}

.markdown-body .admonition-title {
  font-weight: bold;
  margin: 0;
}

.markdown-body .admonition>.admonition-title {
  color: #333;
}

.markdown-body .attention>.admonition-title {
  color: #a6d796;
}

.markdown-body .caution>.admonition-title {
  color: #d7a796;
}

.markdown-body .hint>.admonition-title {
  color: #96c6d7;
}

.markdown-body .danger>.admonition-title {
  color: #c25f77;
}

.markdown-body .question>.admonition-title {
  color: #96a6d7;
}

.markdown-body .note>.admonition-title {
  color: #d7c896;
}

.markdown-body .admonition:before,
.markdown-body .attention:before,
.markdown-body .caution:before,
.markdown-body .hint:before,
.markdown-body .danger:before,
.markdown-body .question:before,
.markdown-body .note:before {
  font: normal normal 16px fontawesome-mini;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  line-height: 1.5;
  color: #333;
  position: absolute;
  left: 0;
  top: 0;
  padding-top: 10px;
  padding-left: 10px;
}

.markdown-body .admonition:before {
  content: "\f056\00a0";
  color: 333;
}

.markdown-body .attention:before {
  content: "\f058\00a0";
  color: #a6d796;
}

.markdown-body .caution:before {
  content: "\f06a\00a0";
  color: #d7a796;
}

.markdown-body .hint:before {
  content: "\f05a\00a0";
  color: #96c6d7;
}

.markdown-body .danger:before {
  content: "\f057\00a0";
  color: #c25f77;
}

.markdown-body .question:before {
  content: "\f059\00a0";
  color: #96a6d7;
}

.markdown-body .note:before {
  content: "\f040\00a0";
  color: #d7c896;
}

.markdown-body .admonition::after {
  content: normal;
}

.markdown-body .attention {
  border-left: 6px solid #a6d796;
}

.markdown-body .caution {
  border-left: 6px solid #d7a796;
}

.markdown-body .hint {
  border-left: 6px solid #96c6d7;
}

.markdown-body .danger {
  border-left: 6px solid #c25f77;
}

.markdown-body .question {
  border-left: 6px solid #96a6d7;
}

.markdown-body .note {
  border-left: 6px solid #d7c896;
}

.markdown-body .admonition>*:first-child {
  margin-top: 0 !important;
}

.markdown-body .admonition>*:last-child {
  margin-bottom: 0 !important;
}

/* progress bar*/
.markdown-body .progress {
  display: block;
  width: 300px;
  margin: 10px 0;
  height: 24px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #ededed;
  position: relative;
  box-shadow: inset -1px 1px 3px rgba(0, 0, 0, .1);
}

.markdown-body .progress-label {
  position: absolute;
  text-align: center;
  font-weight: bold;
  width: 100%; margin: 0;
  line-height: 24px;
  color: #333;
  text-shadow: 1px 1px 0 #fefefe, -1px -1px 0 #fefefe, -1px 1px 0 #fefefe, 1px -1px 0 #fefefe, 0 1px 0 #fefefe, 0 -1px 0 #fefefe, 1px 0 0 #fefefe, -1px 0 0 #fefefe, 1px 1px 2px #000;
  -webkit-font-smoothing: antialiased !important;
  white-space: nowrap;
  overflow: hidden;
}

.markdown-body .progress-bar {
  height: 24px;
  float: left;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #96c6d7;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .5), inset 0 -1px 0 rgba(0, 0, 0, .1);
  background-size: 30px 30px;
  background-image: -webkit-linear-gradient(
    135deg, rgba(255, 255, 255, .4) 27%,
    transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%,
    transparent 77%, transparent
  );
  background-image: -moz-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -ms-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -o-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
}

.markdown-body .progress-100plus .progress-bar {
  background-color: #a6d796;
}

.markdown-body .progress-80plus .progress-bar {
  background-color: #c6d796;
}

.markdown-body .progress-60plus .progress-bar {
  background-color: #d7c896;
}

.markdown-body .progress-40plus .progress-bar {
  background-color: #d7a796;
}

.markdown-body .progress-20plus .progress-bar {
  background-color: #d796a6;
}

.markdown-body .progress-0plus .progress-bar {
  background-color: #c25f77;
}

.markdown-body .candystripe-animate .progress-bar{
  -webkit-animation: animate-stripes 3s linear infinite;
  -moz-animation: animate-stripes 3s linear infinite;
  animation: animate-stripes 3s linear infinite;
}

@-webkit-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@-moz-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

.markdown-body .gloss .progress-bar {
  box-shadow:
    inset 0 4px 12px rgba(255, 255, 255, .7),
    inset 0 -12px 0 rgba(0, 0, 0, .05);
}

/* MultiMarkdown Critic Blocks */
.markdown-body .critic_mark {
  background: #ff0;
}

.markdown-body .critic_delete {
  color: #c82829;
  text-decoration: line-through;
}

.markdown-body .critic_insert {
  color: #718c00 ;
  text-decoration: underline;
}

.markdown-body .critic_comment {
  color: #8e908c;
  font-style: italic;
}

.markdown-body .headeranchor {
  font: normal normal 16px fontawesome-mini;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.headeranchor:before {
  content: '\e157';
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 4px 0.25em -20px;
  vertical-align: middle;
}

.markdown-body diagram-div, .markdown-body div.uml-sequence-diagram, .markdown-body, div.uml-flowchart {
  overflow: auto;
}

/* Media */
@media only screen and (min-width: 480px) {
  .markdown-body {
    font-size:14px;
  }
}

@media only screen and (min-width: 768px) {
  .markdown-body {
    font-size:16px;
  }
}

@media print {
  .markdown-body * {
    background: transparent !important;
    color: black !important;
    filter:none !important;
    -ms-filter: none !important;
  }

  .markdown-body {
    font-size:12pt;
    max-width:100%;
    outline:none;
    border: 0;
  }

  .markdown-body a,
  .markdown-body a:visited {
    text-decoration: underline;
  }

  .markdown-body .headeranchor-link {
    display: none;
  }

  .markdown-body a[href]:after {
    content: " (" attr(href) ")";
  }

  .markdown-body abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .markdown-body .ir a:after,
  .markdown-body a[href^="javascript:"]:after,
  .markdown-body a[href^="#"]:after {
    content: "";
  }

  .markdown-body pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .markdown-body pre,
  .markdown-body blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  .markdown-body .progress,
  .markdown-body .progress-bar {
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }

  .markdown-body .progress {
    border: 1px solid #ddd;
  }

  .markdown-body .progress-bar {
    height: 22px;
    border-right: 1px solid #ddd;
  }

  .markdown-body tr,
  .markdown-body img {
    page-break-inside: avoid;
  }

  .markdown-body img {
    max-width: 100% !important;
  }

  .markdown-body p,
  .markdown-body h2,
  .markdown-body h3 {
    orphans: 3;
    widows: 3;
  }

  .markdown-body h2,
  .markdown-body h3 {
    page-break-after: avoid;
  }
}
</style><style>/*GitHub*/
.highlight {background-color:#f7f7f7;color:#333333;}
.highlight .hll {background-color:#ffffcc;}
.highlight .c{color:#999988;font-style:italic}
.highlight .err{color:#a61717;background-color:#e3d2d2}
.highlight .k{font-weight:bold}
.highlight .o{font-weight:bold}
.highlight .cm{color:#999988;font-style:italic}
.highlight .cp{color:#999999;font-weight:bold}
.highlight .c1{color:#999988;font-style:italic}
.highlight .cs{color:#999999;font-weight:bold;font-style:italic}
.highlight .gd{color:#000000;background-color:#ffdddd}
.highlight .ge{font-style:italic}
.highlight .gr{color:#aa0000}
.highlight .gh{color:#999999}
.highlight .gi{color:#000000;background-color:#ddffdd}
.highlight .go{color:#888888}
.highlight .gp{color:#555555}
.highlight .gs{font-weight:bold}
.highlight .gu{color:#800080;font-weight:bold}
.highlight .gt{color:#aa0000}
.highlight .kc{font-weight:bold}
.highlight .kd{font-weight:bold}
.highlight .kn{font-weight:bold}
.highlight .kp{font-weight:bold}
.highlight .kr{font-weight:bold}
.highlight .kt{color:#445588;font-weight:bold}
.highlight .m{color:#009999}
.highlight .s{color:#dd1144}
.highlight .n{color:#333333}
.highlight .na{color:teal}
.highlight .nb{color:#0086b3}
.highlight .nc{color:#445588;font-weight:bold}
.highlight .no{color:teal}
.highlight .ni{color:purple}
.highlight .ne{color:#990000;font-weight:bold}
.highlight .nf{color:#990000;font-weight:bold}
.highlight .nn{color:#555555}
.highlight .nt{color:navy}
.highlight .nv{color:teal}
.highlight .ow{font-weight:bold}
.highlight .w{color:#bbbbbb}
.highlight .mf{color:#009999}
.highlight .mh{color:#009999}
.highlight .mi{color:#009999}
.highlight .mo{color:#009999}
.highlight .sb{color:#dd1144}
.highlight .sc{color:#dd1144}
.highlight .sd{color:#dd1144}
.highlight .s2{color:#dd1144}
.highlight .se{color:#dd1144}
.highlight .sh{color:#dd1144}
.highlight .si{color:#dd1144}
.highlight .sx{color:#dd1144}
.highlight .sr{color:#009926}
.highlight .s1{color:#dd1144}
.highlight .ss{color:#990073}
.highlight .bp{color:#999999}
.highlight .vc{color:teal}
.highlight .vg{color:teal}
.highlight .vi{color:teal}
.highlight .il{color:#009999}
.highlight .gc{color:#999;background-color:#EAF2F5}
</style><title>HostThreatHunting</title></head><body><article class="markdown-body"><h1 id="examine-pdfs-t1024002">Examine PDFs <a href="https://attack.mitre.org/techniques/T1204/002/">T1024.002</a><a class="headerlink" href="#examine-pdfs-t1024002" title="Permanent link"></a></h1>
<ol>
<li>Use <code>pdfid.py</code> to summarize risky aspects of the file. </li>
<li>Use <code>pdf-parser.py</code> to search for objects within PDFs. </li>
<li>Use <code>peepdf.py</code> to summarize aspects of file and search for objects. </li>
<li>Use <code>swf_mastah.py</code> to extract Flash from PDF files. </li>
<li>Use <a href="https://github.com/cogent/origami-pdf">origami-pdf</a> to analyze PDFs. </li>
</ol>
<h1 id="de-obfuscate-code-t1027010">De-obfuscate Code <a href="https://attack.mitre.org/techniques/T1027/010/">T1027.010</a><a class="headerlink" href="#de-obfuscate-code-t1027010" title="Permanent link"></a></h1>
<ol>
<li>Beautify the script using Notepad++ and JSTool plugins such as JSMin and JSFormat. </li>
<li>Use <a href="https://spidermonkey.dev/">SpiderMonkey</a> to analyze JavaScript and VBScript. </li>
<li>Use <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/cscript">CScript</a> to analyze JavaScript and VBScript. </li>
<li>Use <a href="https://github.com/CapacitorSet/box-js">box-js</a> within the command line to analyze JavaScript. </li>
<li>Use <code>base64dump.py</code> to decode Base64 strings. </li>
</ol>
<h1 id="view-embedded-strings-t1024">View Embedded Strings <a href="https://attack.mitre.org/techniques/T1204/">T1024</a><a class="headerlink" href="#view-embedded-strings-t1024" title="Permanent link"></a></h1>
<ol>
<li>Run <code>pestr</code> on a linux operating system to view strings on an executable. </li>
<li>Run <code>strings -a</code> on a linux OS to view strings on an executable. </li>
<li>Run <code>strings --encoding=l</code> on a lnux OS to view strings of an executable. </li>
<li>Place the file in <a href="https://www.winitor.com/download">PeStudio</a>. </li>
</ol>
<h1 id="identify-wmi-activity-t1047">Identify WMI Activity <a href="https://attack.mitre.org/techniques/T1047/">T1047</a><a class="headerlink" href="#identify-wmi-activity-t1047" title="Permanent link"></a></h1>
<ol>
<li>Focus on ShimCache, AmCache.hve, and Prefetch with <code>wmic.exe</code> on source machine. </li>
<li>Focus on ShimCache, AmCache.hve, and Prefetch with <code>wmic.exe</code>, <code>scrons.exe</code>, <code>mofcomp.exe</code>, or <code>wmiprvse.exe</code> on target machine. </li>
<li>Use <code>eventvwr.msc</code> with Microsoft-Windows-WMI-Activity%4Operational for event ID 5857, 5860, and 5861 for <code>wmiprvse</code> execution. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs event ID 4688. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs event ID 4648.</li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and Event ID 20. </li>
<li>Look for MOF files within <code>C:\Windows\System32\wbem\AutoRecover</code> or <code>C:\Windows\System32\wbem\mofcomp.exe</code>. </li>
<li>Look for MOF files in registry <code>HKLM\SOFTWARE\Microsoft\Wbem\CIMON</code>. </li>
</ol>
<h1 id="examine-rdp-connections-t1563002-t1210">Examine RDP Connections <a href="https://attack.mitre.org/techniques/T1563/002/">T1563.002</a> <a href="https://attack.mitre.org/techniques/T1210/">T1210</a><a class="headerlink" href="#examine-rdp-connections-t1563002-t1210" title="Permanent link"></a></h1>
<ol>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs event ID 4648. </li>
<li>Use <code>eventvwr.msc</code> with Microsoft-Windows-TerminalServices-RDPClient%4Operational for eventid 1024 and 1102 with destination hostname or IP address. </li>
<li>View registry <code>NTUSER\Software\Microsoft\Terminal Server Client\Servers</code> to find RDP connections per user. </li>
<li>Focus on ShimCache and AmCache.hve with <code>mstsc.exe</code> for RDP source machine. </li>
<li>Focus on prefetch with <code>mstsc.exe</code>,<code>rdpclip.exe</code> or <code>tstheme.exe</code>within the name of the file. </li>
<li>View jumplists at <code>C:\Users\[username]\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations\</code> for RDP destinations and times. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs event ID 4624 for logon type 10. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs event ID 4778/4779 for logon source and username. </li>
<li>Use <code>eventvwr.msc</code> with Microsoft-Windows-RemoteDesktopServices-RdpCoreTS%4Operational for eventid 131 and 98 for connection attempt IPs and successful connections. </li>
<li>Use <code>eventvwr.msc</code> with Microsoft-Windows-TerminalServices-RDPClient%4Operational for eventid 1149 with source IP and Logon username. </li>
<li>Use <code>eventvwr.msc</code> with Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational for eventid 21, 22, 25, and 41 for source IP or logon username. </li>
<li>Focus on ShimCache and AmCache.hve with <code>rdpclip.exe</code> or <code>tstheme.exe</code> for RDP destination machine. </li>
</ol>
<h1 id="view-change-to-logging-t1070001">View Change to Logging <a href="https://attack.mitre.org/techniques/T1070/001/">T1070.001</a><a class="headerlink" href="#view-change-to-logging-t1070001" title="Permanent link"></a></h1>
<ol>
<li>Use <code>eventvwr.msc</code> with Windows System Event logs 4719. </li>
</ol>
<h1 id="view-account-changes-t1098">View Account Changes <a href="https://attack.mitre.org/techniques/T1098/">T1098</a><a class="headerlink" href="#view-account-changes-t1098" title="Permanent link"></a></h1>
<ol>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs event id 4724 to view password reset. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs event id 4735 to view local group changes. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs event id 4738 to view local password change. </li>
<li>Use <code>wevutil.exe</code> and search for appropriate Windows Security Eveents logs. <ul>
<li>Command to use is <code>wevutil.exe qe Security /q:"*[System[EventID=4725 or EventID=4722 or EventID=4723 or EventID=4724 or EventID=4726 or EventID=4767)]]</code></li>
</ul>
</li>
</ol>
<h1 id="examine-macros-in-word-documents-t1137001-t1564007-t1024002">Examine Macros in Word Documents <a href="https://attack.mitre.org/techniques/T1137/001/">T1137.001</a> <a href="https://attack.mitre.org/techniques/T1564/007/">T1564.007</a> <a href="https://attack.mitre.org/techniques/T1204/002/">T1024.002</a><a class="headerlink" href="#examine-macros-in-word-documents-t1137001-t1564007-t1024002" title="Permanent link"></a></h1>
<ol>
<li>Use <a href="https://gist.github.com/kost/eb95e623f1b286aee890">wmd.pl</a> to extract metadata. </li>
<li>Use <code>olevba.py</code> to examine metadata. </li>
<li>Unzip the docx to deflate media and other sections of the document. </li>
<li>Use <code>oledump.py</code> to view the macros within a document. </li>
<li>View macros within p-code called <a href="https://github.com/bontchev/pcodedmp">pcodedmp.py</a>. </li>
</ol>
<h1 id="examine-rtf-documents-t1024002">Examine RTF Documents <a href="https://attack.mitre.org/techniques/T1204/002/">T1024.002</a><a class="headerlink" href="#examine-rtf-documents-t1024002" title="Permanent link"></a></h1>
<ol>
<li>Use <code>rtfdump.py</code> to examine the file. </li>
</ol>
<h1 id="determine-persistence-at-startup-in-registry-t1547001">Determine Persistence at Startup in Registry <a href="https://attack.mitre.org/techniques/T1547/001/">T1547.001</a><a class="headerlink" href="#determine-persistence-at-startup-in-registry-t1547001" title="Permanent link"></a></h1>
<ol>
<li>View registry at <code>HKLM\Software\Microsoft\Windows\CurrentVersion\Runonce</code>. </li>
<li>View registry at <code>HKLM\Software\Microsoft\Windows\CurrentVersion\policies\Explorer\Run</code>.</li>
<li>View registry at <code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run</code>. </li>
<li>View registry at <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Run</code>. </li>
<li>View registry at <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code>. </li>
<li>View registry at <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Runonce</code>. </li>
</ol>
<h1 id="detect-external-devices-t1025">Detect External Devices <a href="https://attack.mitre.org/techniques/T1025/">T1025</a><a class="headerlink" href="#detect-external-devices-t1025" title="Permanent link"></a></h1>
<ol>
<li>Track USBs in machine at <code>SYSTEM\CurrentControlSet\Enum\USBSTOR</code> or <code>SYSTEM\CurrentControlSet\Enum\USB</code>. </li>
<li>Create timeline for USB connections with <code>C:\Windows\inf\setupapi.dev.log</code> or <code>SYSTEM\CurrentControlSet\Enum\USBSTOR\Ven_Prod_Version\USB</code>. </li>
<li>Find the user with the USB device at <code>SYSTEM\MountedDevices</code> with a GUID or <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2</code>. </li>
<li>Find the USB volume serial number at <code>SOFTWARE\Microsoft\WindowsNT\CurrentVersion\ENDMgmt</code>. </li>
<li>Find the drive letter for the USB device <code>SOFTWARE\Microsoft\Windows Portable Devices\Devices</code> or <code>SYSTEM\MountedDevices</code>. </li>
<li>Device mounting creates a link file at <code>C:\%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Recent</code> or <code>C:\%USERPROFILE%\AppData\Roaming\Microsoft\Office\Recent</code>. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 20001. </li>
<li>View USB connection time at <code>HKLM\Software\Microsoft\Windows NT\CurrentVersion\EMDMgmt</code>. </li>
</ol>
<h1 id="identify-timezone-no-ttp">Identify TimeZone [No TTP]<a class="headerlink" href="#identify-timezone-no-ttp" title="Permanent link"></a></h1>
<ol>
<li>Look at <code>SYSTEM\CurrentControlSet\Control\TimeZoneInformation</code> within the System Hive. </li>
</ol>
<h1 id="explore-file-deletion-t1485-t1070004-t1070009">Explore File Deletion <a href="https://attack.mitre.org/techniques/T1485/">T1485</a> <a href="https://attack.mitre.org/techniques/T1070/004/">T1070.004</a> <a href="https://attack.mitre.org/techniques/T1070/009/">T1070.009</a><a class="headerlink" href="#explore-file-deletion-t1485-t1070004-t1070009" title="Permanent link"></a></h1>
<ol>
<li>Focus on WordWheelQuery from the START menu located at <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery</code>. </li>
<li>View the Last Visited MRU at <code>NTUSER.dat\Software\Microsoft\Windows\CurrentVersion\Explorer\Comdlg32\LastVisited[PID]MRU</code>. </li>
<li>Focus on the thumbnails/thumbscache that are not deleted after file deletion at <code>C:\%USERPROFILE%\AppData\Local\Microsoft\Windows\Explorer</code>. </li>
<li>Examine the recycle bin at <code>C:\$Recycle.bin</code>. </li>
<li>View files access from IE at <code>%USERPROFILE%\AppData\Local\Microsoft\Windows\WebCache\WebCacheV*.dat</code>. </li>
<li>Use <a href="https://github.com/abelcheung/rifiuti2">Rifiuti2</a> to exmaine the Recycle Bin. </li>
</ol>
<h1 id="examine-executables-t1547004-t1059006-t15559001-t1027004-t1027004-t1055002">Examine Executables <a href="https://attack.mitre.org/techniques/T1547/004/">T1547.004</a> <a href="https://attack.mitre.org/techniques/T1059/006/">T1059.006</a> <a href="/home/ajread/threat_hunting/threat_hunting_resource/%5BT1070.004%5D%28https%3A/attack.mitre.org/techniques/T1559/001/%29">T15559.001</a> <a href="/home/ajread/threat_hunting/threat_hunting_resource/%5BT1070.004%5D%28https%3A/attack.mitre.org/techniques/T1027/004/%29">T1027.004</a> <a href="/home/ajread/threat_hunting/threat_hunting_resource/%5BT1070.009%5D%28https%3A/attack.mitre.org/techniques/T1027/009/%29">T1027.004</a> <a href="https://attack.mitre.org/techniques/T1055/002">T1055.002</a><a class="headerlink" href="#examine-executables-t1547004-t1059006-t15559001-t1027004-t1027004-t1055002" title="Permanent link"></a></h1>
<ol>
<li>View the registry at <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{GUID}\Count</code> where the GUID is specific for the OS. </li>
<li>View the Windows Background Activity Monitor at <code>SYSTEM\CurrentControlSet\Services\bam\UserSettings\{SID}</code> or <code>SYSTEM\CurrentControlSet\Services\dam\UserSettings\{SID}</code></li>
<li>View the Last Visited MRU at <code>NTUSER.dat\Software\Microsoft\Windows\CurrentVersion\Explorer\Comdlg32\LastVisited[PID]MRU</code>. </li>
<li>View the RunMRU at <code>NTUser.dat\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU</code> for Start-&gt; Run execution. </li>
<li>View the RecentApps key for program execution at <code>NTUser.dat\Software\Microsoft\Windows\Current Version\Search\RecentApps</code> where each GUID is a specific application. </li>
<li>View the AppCompatCache to determine time of execution and name of executable at <code>SYSTEM\CurrentControlSet\Control\SessionManager\AppCompatCache</code>. </li>
<li>Utilize jump lists at <code>C:\%UserProfile%\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations</code> to view user access of executables. </li>
<li>Use <code>PECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> with Command line. <ul>
<li>Command to use <code>PECmd.exe -f [prefetch_file]</code></li>
</ul>
</li>
<li>View prefetch files at <code>C:\Windows\Prefetch</code> for program execution. </li>
<li>View the Amcache or recentfile cache for data storage during process creation at <code>C:\Windows\AppCompat\Programs\Amcache.hve</code>.</li>
<li>Run <code>pestr</code> on a linux operating system to view strings on an executable. </li>
<li>Run <code>strings -a</code> on a linux OS to view strings on an executable. </li>
<li>Run <code>strings --encoding=l</code> on a lnux OS to view strings of an executable. </li>
<li>Place the file in <a href="https://www.winitor.com/download">PeStudio</a>. </li>
<li>Run <code>peframe</code> on a linux machine to view imports and other file properties. </li>
<li>Place the file in <a href="https://github.com/horsicq/Detect-It-Easy">DetectItEasy</a>. </li>
<li>Place the file in <a href="http://www.exeinfo.byethost18.com/?i=1">ExeInfoPE</a>. </li>
<li>Analyze the file with <a href="https://aluigi.altervista.org/mytoolz.htm">signsrch</a>. </li>
<li>Analyze the file with <a href="https://tzworks.com/prototype_page.php?proto_id=15">pescan</a>. </li>
<li>Analyze the file with <a href="https://git.korelogic.com/mastiff.git/">MASTIFF</a>. </li>
<li>Analyze the file with <a href="https://exiftool.org/">Exiftool</a>. </li>
<li>Analyze the file with <a href="https://mark0.net/soft-trid-e.html">TrID</a>. </li>
<li>Analyze the file with <a href="https://github.com/viper-framework/viper">Viper</a>. </li>
<li>Analyze the file with <a href="https://github.com/struppigel/PortEx">PortEx</a>.</li>
<li>Examine the execution within <a href="https://www.procdot.com/downloadprocdotbinaries.htm">ProcDot</a>. </li>
</ol>
<h1 id="examine-the-shimcacheamcache">Examine the Shimcache/Amcache<a class="headerlink" href="#examine-the-shimcacheamcache" title="Permanent link"></a></h1>
<ol>
<li>View the AppCompatCache to determine time of execution and name of executable at <code>SYSTEM\CurrentControlSet\Control\SessionManager\AppCompatCache</code>. </li>
<li>View the Amcache or recentfile cache for data storage during process creation at <code>C:\Windows\AppCompat\Programs\Amcache.hve</code>. </li>
<li>Focus on ShimCache and AmCache.hve with <code>mstsc.exe</code> for RDP source connections. </li>
<li>Focus on ShimCache and AmCache.hve with <code>rdpclip.exe</code> or <code>tstheme.exe</code> for RDP destination machine. </li>
</ol>
<h1 id="examine-application-crashes-t1499004">Examine Application Crashes <a href="https://attack.mitre.org/techniques/T1499/004">T1499.004</a><a class="headerlink" href="#examine-application-crashes-t1499004" title="Permanent link"></a></h1>
<ol>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 1001. </li>
</ol>
<h1 id="examine-smb-sharessessions-t1021">Examine SMB Shares/Sessions <a href="https://attack.mitre.org/techniques/T1021/002/">T1021</a><a class="headerlink" href="#examine-smb-sharessessions-t1021" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Get-WmiObject</code> within Powershell. <ul>
<li>Command to use is <code>Get-WmiObject -Class win32_share</code></li>
</ul>
</li>
<li>Use <code>Get-SMBSession</code> within Powershell. <ul>
<li>Command to use is <code>Get-SmbSession | Select-Object ClientComputerName,Dialect,SecondsExist,SecondsIdle</code></li>
</ul>
</li>
<li>Use <code>Get-SMBMapping</code> within Powershell. </li>
<li>Examine remotely mapped shares at <code>NTUSER\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2</code> on source machine. </li>
<li>Look for ShimCache, Amcache, BAM, DAM, or Prefetch with <code>net.exe</code> or <code>net1.exe</code> on source machine. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs event ID 4648 on source machine. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs event ID 4624, 4672, 4776, 4768, 4769, 5140, and 5145 on destination machine. </li>
</ol>
<h1 id="examine-services-t1569-t1569002">Examine Services <a href="https://attack.mitre.org/techniques/T1569/">T1569</a> <a href="https://attack.mitre.org/techniques/T1569/002">T1569.002</a><a class="headerlink" href="#examine-services-t1569-t1569002" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Get-Service</code> within Powershell.</li>
<li>Use <code>Get-CimInstance -ClassName Win32_Service | Format-List Name, Caption, Description,PathName</code> within Powershell. </li>
<li>Use <code>Get-WinEvent</code> within Powershell looking for Event ID 7045 in the Security Log. <ul>
<li>Command to use is <code>Get-WinEvent -LogName System | Where-Object -Property ID -EQ 7045 | Format-List -Property TimeCreated,Message</code>. </li>
</ul>
</li>
<li>Use <a href="https://www.volatilityfoundation.org/releases-vol3">volatility</a> with a forensic image. <ul>
<li>Version 3 uses windows.svcscan.SvcScan</li>
</ul>
</li>
<li>Use <code>DeepBlueCLI</code> (from <a href="https://github.com/sans-blue-team/DeepBlueCLI">here</a>) and Powershell. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4697. </li>
<li>Use <code>eventvwr.msc</code> with Windows System Event logs 7034, 7035, 7036, 7040 in that order. </li>
<li>Use <code>eventvwr.msc</code> with Windows System Event logs 6045 for service installation on a server. </li>
<li>Use <code>sc.exe</code> to query services. <ul>
<li>Command to use <code>sc.exe query state= all</code></li>
</ul>
</li>
<li>Use <code>wevutil.exe</code> and search for appropriate Windows Security Events logs. <ul>
<li>Command to use is <code>wevutil.exe qe Security /q:"*[System[(EventID=7045)]]</code></li>
</ul>
</li>
<li>Use <code>eventvwr.msc</code> with Windows System Event logs 7045. </li>
<li>View registry for new service creations at <code>SYSTEM\CurrentControlSet\Services\[servicename]</code>. </li>
</ol>
<h1 id="analyze-onenote-files-t1137">Analyze OneNote Files <a href="https://attack.mitre.org/techniques/T1137">T1137</a><a class="headerlink" href="#analyze-onenote-files-t1137" title="Permanent link"></a></h1>
<ol>
<li>Use <code>OneNoteAnalyzer</code> found <a href="https://github.com/knight0x07/OneNoteAnalyzer">here</a></li>
</ol>
<h1 id="unsigned-files-in-cwindowssystem32-t1587002">Unsigned Files in C:\Windows\System32 <a href="https://attack.mitre.org/techniques/T1587/002">T1587.002</a><a class="headerlink" href="#unsigned-files-in-cwindowssystem32-t1587002" title="Permanent link"></a></h1>
<ol>
<li>Use <code>sigcheck</code> within Sysinternals.<ul>
<li><code>sigcheck -u -e C:\Windows\System32 -accepteula</code></li>
</ul>
</li>
</ol>
<h1 id="alternate-data-streams-t1564004">Alternate Data Streams <a href="https://attack.mitre.org/techniques/T1564/004">T1564.004</a><a class="headerlink" href="#alternate-data-streams-t1564004" title="Permanent link"></a></h1>
<ol>
<li>Use <code>streams</code> within Sysinternals<ul>
<li><code>streams C:\Users\Administrator\Desktop\maliciousfile.txt -accepteula</code></li>
</ul>
</li>
<li>Use <code>more</code> to view the ADS files on the command line.<ul>
<li><code>more &lt; C:\Users\Administrator\Desktop\maliciousfile.txt:ads.txt</code></li>
</ul>
</li>
<li>Use <code>Get-WinEvent</code> with Sysmon Event Logs. <ul>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=8'</code></li>
</ul>
</li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and Event ID 8. </li>
</ol>
<h1 id="autoruns-t1547">Autoruns <a href="https://attack.mitre.org/techniques/T1547">T1547</a><a class="headerlink" href="#autoruns-t1547" title="Permanent link"></a></h1>
<ol>
<li>Use <code>autoruns</code> within Sysinternals <ul>
<li><code>autoruns</code></li>
</ul>
</li>
<li>Use <code>osquery</code> on the Windows Command line. <ul>
<li>Command to use in interactive mode is <code>select path from autoexec;</code>. </li>
</ul>
</li>
</ol>
<h1 id="dump-processes-on-host-t1059">Dump Processes on Host <a href="https://attack.mitre.org/techniques/T1059">T1059</a><a class="headerlink" href="#dump-processes-on-host-t1059" title="Permanent link"></a></h1>
<ol>
<li>Use <code>procdump</code> within Sysinternals <ul>
<li><code>procdump -accepteula</code></li>
</ul>
</li>
</ol>
<h1 id="explore-processes-t1059-t1055">Explore Processes <a href="https://attack.mitre.org/techniques/T1059">T1059</a> <a href="https://attack.mitre.org/techniques/T1055/">T1055</a><a class="headerlink" href="#explore-processes-t1059-t1055" title="Permanent link"></a></h1>
<ol>
<li>Use <code>procexp</code> within Sysinternals<ul>
<li><code>procexp -accepteula</code></li>
</ul>
</li>
<li>Use <a href="https://processhacker.sourceforge.io/">Process Hacker</a><ul>
<li>Download as Desktop application </li>
</ul>
</li>
<li>Use <code>procmon</code> within SysInternals<ul>
<li><code>procmon -accepteula</code></li>
</ul>
</li>
<li>Use <code>Get-WinEvent</code> with Sysmon Event Logs. <ul>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=1'</code></li>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=8'</code></li>
</ul>
</li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and Event ID 1. </li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and Event ID 8. </li>
<li>Use <code>osquery</code> on the Windows Command line. <ul>
<li>Command to use in interactive mode is <code>select sid,path from userassist</code>. </li>
</ul>
</li>
<li>Use <code>DeepBlueCLI</code> (from <a href="https://github.com/sans-blue-team/DeepBlueCLI">here</a>) and Powershell. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4688. </li>
<li>Use <code>Get-Process</code> within Powershell.</li>
<li>Use <code>Get-CimInstance -Class Win32_Process | Select-Object ProcessId, ProcessName,CommandLine</code> within Powershell.</li>
<li>Use <a href="https://www.volatilityfoundation.org/releases-vol3">volatility</a> with a forensic image. <ul>
<li>Version 3 uses windows.pslist.Pslist, windows.pstree.PsTree, windows.netscan.NetScan, windows.cmdline.Cmdline, windows.dlllist.DllList</li>
</ul>
</li>
<li>Use <a href="https://github.com/MarkBaggett/srum-dump">SRUM Dump</a> to examine system usages related to processes. </li>
<li>View the registry at <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{GUID}\Count</code> where the GUID is specific for the OS. </li>
<li>View the Windows Background Activity Monitor at <code>SYSTEM\CurrentControlSet\Services\bam\UserSettings\{SID}</code> or <code>SYSTEM\CurrentControlSet\Services\dam\UserSettings\{SID}</code></li>
<li>View the Last Visited MRU at <code>NTUSER.dat\Software\Microsoft\Windows\CurrentVersion\Explorer\Comdlg32\LastVisited[PID]MRU</code>. </li>
<li>View the RunMRU at <code>NTUser.dat\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU</code> for Start-&gt; Run execution. </li>
<li>Examine the execution within <a href="https://www.procdot.com/downloadprocdotbinaries.htm">ProcDot</a>. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4663. </li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and Event ID 10.</li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and Event ID 25.</li>
<li></li>
</ol>
<h1 id="explore-registry-activity-t1564001-t1574t1112t1070007-t1070009t1003002t1027011t1137t1012-t1033-t1569002-t1552002">Explore Registry Activity <a href="https://attack.mitre.org/techniques/T1564/001">T1564.001</a> <a href="https://attack.mitre.org/techniques/T1574">T1574</a><a href="https://attack.mitre.org/techniques/T1112">T1112</a><a href="https://attack.mitre.org/techniques/T1070/007">T1070.007</a> <a href="https://attack.mitre.org/techniques/T1070/009">T1070.009</a><a href="https://attack.mitre.org/techniques/T1003/002">T1003.002</a><a href="https://attack.mitre.org/techniques/T1027/011">T1027.011</a><a href="https://attack.mitre.org/techniques/T1137">T1137</a><a href="https://attack.mitre.org/techniques/T1012">T1012</a> <a href="https://attack.mitre.org/techniques/T1033">T1033</a> <a href="https://attack.mitre.org/techniques/T1569/002">T1569.002</a> <a href="https://attack.mitre.org/techniques/T1552/002">T1552.002</a><a class="headerlink" href="#explore-registry-activity-t1564001-t1574t1112t1070007-t1070009t1003002t1027011t1137t1012-t1033-t1569002-t1552002" title="Permanent link"></a></h1>
<ol>
<li>Use <code>procmon</code> within SysInternals<ul>
<li><code>procmon -accepteula</code></li>
</ul>
</li>
<li>Use <code>Get-WinEvent</code> with Sysmon Event Logs. <ul>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=13'</code></li>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=12'</code></li>
</ul>
</li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and Event ID 12. </li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and Event ID 13. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4657. </li>
<li>Use <code>Get-ChildItem</code> with the specific registry key in Powershell.</li>
<li>Use <code>Get-ItemProperty</code> with the specific registry key in Powershell.</li>
<li>Use <a href="https://github.com/Seabreg/Regshot">Regshot</a> to compare initial registry with final registry post execution. </li>
<li>Use <a href="https://github.com/keydet89/RegRipper3.0">RegRipper</a>. </li>
<li>Look for registry modifications to <code>HKLM\SYSTEM\CurrentControlSet\Services\&lt;NetworkProviderName&gt;\NetworkProvider</code>, <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\
Notification Packages</code>, or <code>HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order</code>. </li>
</ol>
<h1 id="explore-scheduled-tasks-t1036004-t1053005">Explore Scheduled Tasks <a href="https://attack.mitre.org/techniques/T136/004">T1036.004</a> <a href="https://attack.mitre.org/techniques/T1053/005">T1053.005</a><a class="headerlink" href="#explore-scheduled-tasks-t1036004-t1053005" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Get-WinEvent</code> with Sysmon Event Logs. <ul>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=1'</code></li>
</ul>
</li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and Event ID 1. </li>
<li>Use <code>Get-ScheduledTask</code> within Powershell. <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/procmon">https://learn.microsoft.com/en-us/sysinternals/downloads/procmon</a><ul>
<li>Command to use is <code>Get-ScheduledTask -TaskName [TaskName]</code></li>
</ul>
</li>
<li>Use <code>Export-ScheduledTask</code> within Powershell. <ul>
<li>Command to use is <code>Get-ScheduledTask -TaskName [Name]</code>. </li>
</ul>
</li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4698. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4702. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4699. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4701. </li>
<li>Identify processes of <code>at.exe</code> or <code>schtasks.exe</code> on the source machine. </li>
<li>View registry at <code>Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</code> or <code>Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</code> on target machine to find scheduled tasks. </li>
</ol>
<h1 id="explore-process-thread-activity-t1134003-t1574005-t1574010-t1055003-t1055005-t1620">Explore Process Thread Activity <a href="https://attack.mitre.org/techniques/T1134/003">T1134.003</a> <a href="https://attack.mitre.org/techniques/T574/005">T1574.005</a> <a href="https://attack.mitre.org/techniques/T1574/010">T1574.010</a> <a href="https://attack.mitre.org/techniques/T1055/003">T1055.003</a> <a href="https://attack.mitre.org/techniques/T1055/005">T1055.005</a> <a href="https://attack.mitre.org/techniques/T1620">T1620</a><a class="headerlink" href="#explore-process-thread-activity-t1134003-t1574005-t1574010-t1055003-t1055005-t1620" title="Permanent link"></a></h1>
<ol>
<li>Use <code>procmon</code> within SysInternals<ul>
<li><code>procmon -accepteula</code></li>
</ul>
</li>
<li>Use <code>Get-WinEvent</code> with Sysmon Event Logs and look at the call trace. <ul>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=10'</code> </li>
</ul>
</li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and look at call trace in Event ID 10. </li>
<li>Use <code>osquery</code> on the Windows Command line. <ul>
<li>Command to use in interactive mode is <code>select sid,path from userassist;</code>. </li>
</ul>
</li>
<li>Use <code>DeepBlueCLI</code> (from <a href="https://github.com/sans-blue-team/DeepBlueCLI">here</a>) and Powershell. </li>
<li>Examine the execution within <a href="https://www.procdot.com/downloadprocdotbinaries.htm">ProcDot</a>. </li>
<li>Examine changes in DLLs residing in <code>C:\Windows\System32</code>. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4663. </li>
</ol>
<h1 id="explore-file-read-activity-no-ttp">Explore File Read Activity [No TTP]<a class="headerlink" href="#explore-file-read-activity-no-ttp" title="Permanent link"></a></h1>
<ol>
<li>Use <code>procmon</code> within SysInternals<ul>
<li><code>procmon -accepteula</code></li>
</ul>
</li>
<li>Use <code>LECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> with Command line. <ul>
<li>Command to use <code>LECmd.exe -f [shortcut_file]</code></li>
<li>Shortcut files: <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\</code> or <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Office\Recent\</code></li>
</ul>
</li>
<li>View the OpenSaveMRU to detect file opening at <code>NTUSER.dat\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSave[PID]MRU</code>. </li>
<li>View the Last Visited MRU at <code>NTUSER.dat\Software\Microsoft\Windows\CurrentVersion\Explorer\Comdlg32\LastVisited[PID]MRU</code>. </li>
<li>Examine the RecentFiles at <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs</code>. </li>
<li>Examine Office RecentFiles at <code>NTUSER.DAT\Sofware\Microsoft\Office\VERSION</code>. </li>
<li>Focus on Shellbags for find file access at <code>NTUSER.DAT\Software\Microsoft\Windows\Shell\BagMRU</code> or <code>NTUSER.DAT\Software\Microsoft\Windows\Shell\Bags</code>. </li>
<li>Each open of file creates a link file at <code>C:\%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Recent</code> or <code>C:\%USERPROFILE%\AppData\Roaming\Microsoft\Office\Recent</code>. </li>
<li>Utilize jump lists at <code>C:\%UserProfile%\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations</code> to view user access of files. </li>
<li>Use <code>PECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> with Command line. <ul>
<li>Command to use <code>PECmd.exe -f [prefetch_file]</code></li>
</ul>
</li>
<li>View prefetch files at <code>C:\Windows\Prefetch</code> for program execution. </li>
<li>View files access from IE at <code>%USERPROFILE%\AppData\Local\Microsoft\Windows\WebCache\WebCacheV*.dat</code>. </li>
</ol>
<h1 id="explore-file-download-t1546016-t1027006-t1566002-t1218001-t1189-t1203t1608004-t1218005-t1204001-t1176-t1185">Explore File Download <a href="https://attack.mitre.org/techniques/T1546/016">T1546.016</a> <a href="https://attack.mitre.org/techniques/T1027/006">T1027.006</a> <a href="https://attack.mitre.org/techniques/T1566/002">T1566.002</a> <a href="https://attack.mitre.org/techniques/T1218/001">T1218.001</a> <a href="https://attack.mitre.org/techniques/T1189">T1189</a> <a href="https://attack.mitre.org/techniques/T1203">T1203</a><a href="https://attack.mitre.org/techniques/T1608/004">T1608.004</a> <a href="https://attack.mitre.org/techniques/T1218/005">T1218.005</a> <a href="https://attack.mitre.org/techniques/T1204/001">T1204.001</a> <a href="https://attack.mitre.org/techniques/T1176">T1176</a> <a href="https://attack.mitre.org/techniques/T1185">T1185</a><a class="headerlink" href="#explore-file-download-t1546016-t1027006-t1566002-t1218001-t1189-t1203t1608004-t1218005-t1204001-t1176-t1185" title="Permanent link"></a></h1>
<ol>
<li>View the MRU at <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSave[PID]MRU</code>. </li>
<li>View email attachments at <code>%USERPROFILE%\AppData\Local\Microsoft\Outlook</code>. </li>
<li>View skype history at <code>C\%USERPROFILE%\AppData\Roaming\Skype\[skypename]</code>.</li>
<li>View IE user account and download history at <code>%USERPROFILE%\AppData\Local\Microsoft\Windows\WebCache\WebCacheV*.dat</code>. </li>
<li>View Firefox user account at <code>%USERPROFILE%\AppData\Roaming\Mozilla\Firefox\Profiles\[randomtext].default\places.sqlite</code>.</li>
<li>View chrome user account at <code>%USERPROFILE%\AppData\Local\Google\Chrome\UserData\Default\History</code>. </li>
<li>View firefox download history at <code>%USERPROFILE%\AppData\Roaming\Mozilla\Firefox\Profiles\[randomtext].default\downloads.sqlite</code>.</li>
<li>View user downloads within <code>C:\User\*\Downloads</code>. </li>
</ol>
<h1 id="view-email-attachments-t1566001t1566002">View Email Attachments <a href="https://attack.mitre.org/techniques/T1566/001">T1566.001</a><a href="https://attack.mitre.org/techniques/T1566/002">T1566.002</a><a class="headerlink" href="#view-email-attachments-t1566001t1566002" title="Permanent link"></a></h1>
<ol>
<li>View email attachments at <code>%USERPROFILE%\AppData\Local\Microsoft\Outlook</code>. </li>
</ol>
<h1 id="view-skype-history-no-ttp">View Skype History [No TTP]<a class="headerlink" href="#view-skype-history-no-ttp" title="Permanent link"></a></h1>
<ol>
<li>View skype history at <code>C\%USERPROFILE%\AppData\Roaming\Skype\[skypename]</code>.</li>
</ol>
<h1 id="view-firefox-history-t1189-t1203t1608004-t1218001-t1218005-t1204001-t1176-t1185">View Firefox History <a href="https://attack.mitre.org/techniques/T1189">T1189</a> <a href="https://attack.mitre.org/techniques/T1203">T1203</a><a href="https://attack.mitre.org/techniques/T1608/004">T1608.004</a> <a href="https://attack.mitre.org/techniques/T1218/001">T1218.001</a> <a href="https://attack.mitre.org/techniques/T1218/005">T1218.005</a> <a href="https://attack.mitre.org/techniques/T1204/001">T1204.001</a> <a href="https://attack.mitre.org/techniques/T1176">T1176</a> <a href="https://attack.mitre.org/techniques/T1185">T1185</a><a class="headerlink" href="#view-firefox-history-t1189-t1203t1608004-t1218001-t1218005-t1204001-t1176-t1185" title="Permanent link"></a></h1>
<ol>
<li>View Firefox user account and history at <code>%USERPROFILE%\AppData\Roaming\Mozilla\Firefox\Profiles\[randomtext].default\places.sqlite</code>. </li>
<li>View firefox download history at <code>%USERPROFILE%\AppData\Roaming\Mozilla\Firefox\Profiles\[randomtext].default\downloads.sqlite</code>.</li>
<li>Focus on cookiest at <code>%\USERPROFILE%\AppData\Roaming\Mozilla\Firefox\Profiles\[random].default\cookies.sqlite</code>. </li>
<li>Look at user cache at <code>\%USERPROFILE%\AppData\Local\Mozilla\Firefox\Profiles\[random].default\Cache</code>. </li>
<li>View the session restore within <code>%\USERPROFILE%\AppData\Roaming\Mozilla\Firefox\Profiles\[random].default\sessionstore.js</code>. </li>
<li>View flash cookies at <code>%APPDATA%\Roaming\Macromedia\FlashPlayer\#SharedObjects\[random]</code>. </li>
</ol>
<h1 id="view-chrome-history-t1189-t1203t1608004-t1218001-t1218005-t1204001-t1176-t1185">View Chrome History <a href="https://attack.mitre.org/techniques/T1189">T1189</a> <a href="https://attack.mitre.org/techniques/T1203">T1203</a><a href="https://attack.mitre.org/techniques/T1608/004">T1608.004</a> <a href="https://attack.mitre.org/techniques/T1218/001">T1218.001</a> <a href="https://attack.mitre.org/techniques/T1218/005">T1218.005</a> <a href="https://attack.mitre.org/techniques/T1204/001">T1204.001</a> <a href="https://attack.mitre.org/techniques/T1176">T1176</a> <a href="https://attack.mitre.org/techniques/T1185">T1185</a><a class="headerlink" href="#view-chrome-history-t1189-t1203t1608004-t1218001-t1218005-t1204001-t1176-t1185" title="Permanent link"></a></h1>
<ol>
<li>View chrome user account and history at <code>%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\History</code>. </li>
<li>Focus on cookies at <code>%\USERPROFILE%\AppData\Local\Google\Chrome\UserData\Default\Local Storage</code>. </li>
<li>Look at user cache at <code>%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Cache</code>. </li>
<li>Look at session restore data at <code>%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default</code>. </li>
<li>View flash cookies at <code>%APPDATA%\Roaming\Macromedia\FlashPlayer\#SharedObjects\[random]</code>. </li>
</ol>
<h1 id="explore-internet-explorer-or-edge-browsing-history-t1189-t1203t1608004-t1218001-t1218005-t1204001-t1176-t1185">Explore Internet Explorer or Edge Browsing History <a href="https://attack.mitre.org/techniques/T1189">T1189</a> <a href="https://attack.mitre.org/techniques/T1203">T1203</a><a href="https://attack.mitre.org/techniques/T1608/004">T1608.004</a> <a href="https://attack.mitre.org/techniques/T1218/001">T1218.001</a> <a href="https://attack.mitre.org/techniques/T1218/005">T1218.005</a> <a href="https://attack.mitre.org/techniques/T1204/001">T1204.001</a> <a href="https://attack.mitre.org/techniques/T1176">T1176</a> <a href="https://attack.mitre.org/techniques/T1185">T1185</a><a class="headerlink" href="#explore-internet-explorer-or-edge-browsing-history-t1189-t1203t1608004-t1218001-t1218005-t1204001-t1176-t1185" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Autopsy</code> as a secondary tool. <ul>
<li>View information located at: <code>C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows\WebCache\WebCacheV*.dat</code></li>
</ul>
</li>
<li>Focus on cookies at <code>%\USERPROFILE%\AppData\Roaming\Microsoft\Windows\Cookies</code> or <code>%\USERPROFILE%\AppData\Local\Microsoft\Windows\INetCookies</code>. </li>
<li>Look at user cache or Edge at  <code>\%USERPROFILE%\AppData\Local\Packages\microsoft.microsoftedge_[APPID]\AC\MicrosoftEdge\Cache</code> or for IE at <code>%\USERPROFILE%\AppData\Local\Microsoft\Windows\INetCache\IE</code>. </li>
<li>Look at session restore data in IE at <code>%USERPROFILE%\AppData\Local\Microsoft\Internet Explorer\Recovery</code>. </li>
<li>View flash cookies at <code>%APPDATA%\Roaming\Macromedia\FlashPlayer\#SharedObjects\[random]</code>. </li>
<li>Use <a href="https://github.com/bauman/python-pasco">Pasco</a> to inspect <code>index.dat</code> file. </li>
</ol>
<h1 id="view-cookies-t1606001-t1539-t1550004">View Cookies <a href="https://attack.mitre.org/techniques/T1606/001">T1606.001</a> <a href="https://attack.mitre.org/techniques/T1539">T1539</a> <a href="https://attack.mitre.org/techniques/T1550/004">T1550.004</a><a class="headerlink" href="#view-cookies-t1606001-t1539-t1550004" title="Permanent link"></a></h1>
<ol>
<li>Focus on cookies at <code>%\USERPROFILE%\AppData\Roaming\Microsoft\Windows\Cookies</code> or <code>%\USERPROFILE%\AppData\Local\Microsoft\Windows\INetCookies</code>. </li>
<li>Focus on cookies at <code>%\USERPROFILE%\AppData\Local\Google\Chrome\UserData\Default\Local Storage</code>. </li>
<li>Focus on cookiest at <code>%\USERPROFILE%\AppData\Roaming\Mozilla\Firefox\Profiles\[random].default\cookies.sqlite</code>.</li>
<li>View flash cookies at <code>%APPDATA%\Roaming\Macromedia\FlashPlayer\#SharedObjects\[random]</code>. </li>
</ol>
<h1 id="explore-deleted-files-t1070004-t1485">Explore Deleted Files <a href="https://attack.mitre.org/techniques/T1070/004">T1070.004</a> <a href="https://attack.mitre.org/techniques/T1485">T1485</a><a class="headerlink" href="#explore-deleted-files-t1070004-t1485" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Autopsy</code> as a secondary tool.  </li>
<li>Use <code>LECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> with Command line. <ul>
<li>Command to use <code>LECmd.exe -f [shortcut_file]</code></li>
<li>Shortcut files: <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\</code> or <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Office\Recent\</code></li>
</ul>
</li>
</ol>
<h1 id="explore-shortcut-files-t1080-t1547009-t1222-t1204002httpsattackmitreorgtechniquest1204002">Explore Shortcut Files <a href="https://attack.mitre.org/techniques/T1080">T1080</a> <a href="https://attack.mitre.org/techniques/T1547/009">T1547.009</a> <a href="https://attack.mitre.org/techniques/T1222">T1222</a> [T1204.002])(<a href="https://attack.mitre.org/techniques/T1204/002">https://attack.mitre.org/techniques/T1204/002</a>)<a class="headerlink" href="#explore-shortcut-files-t1080-t1547009-t1222-t1204002httpsattackmitreorgtechniquest1204002" title="Permanent link"></a></h1>
<ol>
<li>Use <code>LECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> with Command line. <ul>
<li>Command to use <code>LECmd.exe -f [shortcut_file]</code></li>
<li>Shortcut files: <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\</code> or <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Office\Recent\</code></li>
</ul>
</li>
<li>Each open of file creates a link file at <code>C:\%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Recent</code> or <code>C:\%USERPROFILE%\AppData\Roaming\Microsoft\Office\Recent</code>. </li>
</ol>
<h1 id="explore-file-write-activity-no-ttp">Explore File Write Activity [No TTP]<a class="headerlink" href="#explore-file-write-activity-no-ttp" title="Permanent link"></a></h1>
<ol>
<li>Use <code>procmon</code> within SysInternals<ul>
<li><code>procmon -accepteula</code></li>
</ul>
</li>
<li>Use <code>LECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> with Command line. <ul>
<li>Command to use <code>LECmd.exe -f [shortcut_file]</code></li>
<li>Shortcut files: <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\</code> or <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Office\Recent\</code></li>
</ul>
</li>
</ol>
<h1 id="explore-prefetch-files-t1204">Explore Prefetch Files <a href="https://attack.mitre.org/techniques/T1204">T1204</a><a class="headerlink" href="#explore-prefetch-files-t1204" title="Permanent link"></a></h1>
<ol>
<li>Use <code>PECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> with Command line. <ul>
<li>Command to use <code>PECmd.exe -f [prefetch_file]</code></li>
</ul>
</li>
<li>View prefetch files at <code>C:\Windows\Prefetch</code> for program execution. </li>
</ol>
<h1 id="parse-windows-10-timeline-no-ttp">Parse Windows 10 Timeline [No TTP]<a class="headerlink" href="#parse-windows-10-timeline-no-ttp" title="Permanent link"></a></h1>
<ol>
<li>Use <code>WxTCmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> on Windows Command line. <ul>
<li>Command to use <code>WxTCmd.exe -f [timeline_file]</code></li>
<li>Timeline file: <code>C:\Users\&lt;username&gt;\AppData\Local\ConnectedDevicesPlatform\{randomfolder}\ActivitiesCache.db</code></li>
</ul>
</li>
</ol>
<h1 id="parse-windows-jump-lists-no-ttp">Parse Windows Jump Lists [No TTP]<a class="headerlink" href="#parse-windows-jump-lists-no-ttp" title="Permanent link"></a></h1>
<ol>
<li>Use <code>JLECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> on Windows Command line. <ul>
<li>Command to use <code>JLECmd.exe -f [jumplist_file]</code></li>
<li>Jump List file: <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations</code></li>
</ul>
</li>
</ol>
<h1 id="explore-file-creation-activity">Explore File Creation Activity<a class="headerlink" href="#explore-file-creation-activity" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Get-WinEvent</code> with Sysmon Event Logs. <ul>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=11'</code></li>
</ul>
</li>
<li>Use <code>eventvwr.msc</code> with Sysmon Event logs and Event ID 11. </li>
<li>Use <code>LECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> with Command line. <ul>
<li>Command to use <code>LECmd.exe -f [shortcut_file]</code></li>
<li>Shortcut files: <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\</code> or <code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Office\Recent\</code></li>
</ul>
</li>
</ol>
<h1 id="explore-powershell-activity-t1059001-t1546013">Explore Powershell Activity <a href="https://attack.mitre.org/techniques/T1059/001">T1059.001</a> <a href="https://attack.mitre.org/techniques/T1546/013">T1546.013</a><a class="headerlink" href="#explore-powershell-activity-t1059001-t1546013" title="Permanent link"></a></h1>
<ol>
<li>Use <code>eventvwr.msc</code> on a Windows system and navigate to Applications and Services Logs -&gt; Microsoft -&gt; Windows -&gt; PowerShell -&gt; Operational. </li>
<li>Use <code>DeepBlueCLI</code> (from <a href="https://github.com/sans-blue-team/DeepBlueCLI">here</a>) and Powershell. </li>
<li>Use <code>wevutil.exe</code> to find Powershell execution. <ul>
<li>Command to use is <code>wevutil.exe qe “Windows PowerShell” /q:"*[System[(EventID=501 or EventID=500)]]"</code></li>
</ul>
</li>
<li>Use <code>wevutil.exe</code> to find Powershell execution to find Get calls. <ul>
<li>Command to use is <code>wevutil.exe qe "Microsoft-Windows-PowerShell/Operational" /q:"*[System[(EventID=4104)]]" /c:1000 /rd:true /f:text | findstr /i "Get-"</code></li>
</ul>
</li>
<li>Use <code>wevutil.exe</code> to find Powershell execution to find invoke execution calls. <ul>
<li>Command to use is <code>wevutil.exe qe "Microsoft-Windows-PowerShell/Operational" /q:"*[System[(EventID=4104)]]" /c:1000 /rd:true /f:text | findstr /i "iex"</code></li>
</ul>
</li>
<li>Focus on ShimCache, AmCache.hve, Prefetch, DAM, and BAM with <code>powershell.exe</code> on source machine.</li>
<li>Use <code>eventvwr.msc</code> to view  Microsoft-Windows-WinRM%4Operational logs for event id 6, 8, 15, 16, or 33 on source machine for remote connection. </li>
<li>Use <code>eventvwr.msc</code> to view  Microsoft-Windows-PowerShell%4Operational for event id 40961, 40962, 8193, 8194, and 8197 on source machine for remote connection. </li>
<li>Use <code>eventvwr.msc</code> to view  Microsoft-Windows-PowerShell%4Operational for event id 4103, 4104, 53504 on target machine for remote connection. </li>
<li>Use <code>eventvwr.msc</code> to view  Microsoft-Windows-WinRM%4Operational logs for event id 91 or 168 on target machine for remote connection. </li>
<li>Use PSReadline to view full script blocks. </li>
</ol>
<h1 id="view-powershell-command-execution-t1059001-t1546013">View PowerShell Command Execution <a href="https://attack.mitre.org/techniques/T1059/001">T1059.001</a> <a href="https://attack.mitre.org/techniques/T1546/013">T1546.013</a><a class="headerlink" href="#view-powershell-command-execution-t1059001-t1546013" title="Permanent link"></a></h1>
<ol>
<li>Use <code>eventvwr.msc</code> on a Windows system and navigate to Applications and Services Logs -&gt; Microsoft -&gt; Windows -&gt; PowerShell -&gt; Operational and look for EventID 4104.  </li>
<li>Use <code>eventvwr.msc</code> on a Windows system and navigate to Applications and Services Logs -&gt; Microsoft -&gt; Windows -&gt; PowerShell -&gt; Operational and look for EventID 800. </li>
<li>Use <code>eventvwr.msc</code> on a Windows system and look for event ID 4104 within the Powershell (Microsoft-Windows-Powershell) log. </li>
<li>Use <code>DeepBlueCLI</code> (from <a href="https://github.com/sans-blue-team/DeepBlueCLI">here</a>) and Powershell. </li>
<li>Focus on ShimCache, AmCache.hve, Prefetch, DAM, and BAM with <code>powershell.exe</code> on source machine.</li>
</ol>
<h1 id="determine-the-number-of-log-names-no-ttp">Determine the Number Of Log Names [No TTP]<a class="headerlink" href="#determine-the-number-of-log-names-no-ttp" title="Permanent link"></a></h1>
<ol>
<li>Use <code>wevutil.exe</code> with Powershell <ul>
<li>Command is <code>wevutil.exe el</code></li>
</ul>
</li>
<li>Use <code>Get-WinEvent</code> with Powershell<ul>
<li>Command is <code>Get-WinEvent -ListLog *</code></li>
</ul>
</li>
</ol>
<h1 id="determine-user-account-creation-t1078002-t1136002-t1098">Determine User Account Creation <a href="https://attack.mitre.org/techniques/T1078/002">T1078.002</a> <a href="https://attack.mitre.org/techniques/T1136/002">T1136.002</a> <a href="https://attack.mitre.org/techniques/T1098">T1098</a><a class="headerlink" href="#determine-user-account-creation-t1078002-t1136002-t1098" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Get-WinEvent</code> with XPath queries using PowerShell. <ul>
<li>Command would be <code>Get-WinEvent -LogName Security -FilterXPath '*/System/EventID=4720 and */EventData/Data[@Name="TargetUserName"]="[UserName]"'</code></li>
</ul>
</li>
<li>Use <code>DeepBlueCLI</code> (from <a href="https://github.com/sans-blue-team/DeepBlueCLI">here</a>) and Powershell. </li>
</ol>
<h1 id="determine-powershell-down-grade-attack-t1059001-t1546013">Determine PowerShell Down Grade Attack <a href="https://attack.mitre.org/techniques/T1059/001">T1059.001</a> <a href="https://attack.mitre.org/techniques/T1546/013">T1546.013</a><a class="headerlink" href="#determine-powershell-down-grade-attack-t1059001-t1546013" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Get-WinEvent</code> using PowerShell. <ul>
<li>Command would be <code>Get-WinEvent -LogName "Windows PowerShell" | Where-Object Id -eq 400 | Foreach-Object {$version = [Version] (
        $_.Message -replace '(?s).*EngineVersion=([\d\.]+)*.*','$1')
    if($version -lt ([Version] "5.0")) { $_ }}</code></li>
</ul>
</li>
<li>User <code>eventvwr.msc</code> on a Windows system and filter for event ID 400 within the PowerShell logs. <ul>
<li><code>EngineVersion</code> will have a different number than other PowerShell logs </li>
</ul>
</li>
</ol>
<h1 id="determine-log-clearing-t1070001-t1485">Determine Log Clearing <a href="https://attack.mitre.org/techniques/T1070/004">T1070.001</a> <a href="https://attack.mitre.org/techniques/T1485">T1485</a><a class="headerlink" href="#determine-log-clearing-t1070001-t1485" title="Permanent link"></a></h1>
<ol>
<li>Use <code>eventvwr.msc</code> on a Windows system and filter for event ID 104 within the Microsoft-Windows-Eventlog source. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 517. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 1102 to view Audit log clearing. </li>
</ol>
<h1 id="explore-group-enumeration-t1069">Explore Group Enumeration <a href="https://attack.mitre.org/techniques/T1069">T1069</a><a class="headerlink" href="#explore-group-enumeration-t1069" title="Permanent link"></a></h1>
<ol>
<li>Use <code>eventvwr.msc</code> on a Windows system and filter for event ID 4799 within Security event logs. </li>
</ol>
<h1 id="determine-number-of-network-connections-t1021">Determine Number of Network Connections <a href="https://attack.mitre.org/techniques/T1021">T1021</a><a class="headerlink" href="#determine-number-of-network-connections-t1021" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Get-WinEvent</code> with Sysmon Event Logs. <ul>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=3 | Measure-Object</code></li>
</ul>
</li>
</ol>
<h1 id="find-common-meterpreter-connections-t1572-t1090-t1001-t1041">Find Common Meterpreter Connections <a href="https://attack.mitre.org/techniques/T1572">T1572</a> <a href="https://attack.mitre.org/techniques/T1090">T1090</a> <a href="https://attack.mitre.org/techniques/T1001">T1001</a> <a href="https://attack.mitre.org/techniques/T1041">T1041</a><a class="headerlink" href="#find-common-meterpreter-connections-t1572-t1090-t1001-t1041" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Get-WinEvent</code> with Sysmon Event Logs. <ul>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=3 and */EventData/Data[@Name="DestinationPort"] and */EventData/Data=4444'</code></li>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=3 and */EventData/Data[@Name="DestinationPort"] and */EventData/Data=5555</code></li>
</ul>
</li>
</ol>
<h1 id="find-mimikatz-execution-t1003005-t1003004-t1003001-t1649-t1558001-t1558002-t1552004-t1550002-t1550003-t1555">Find Mimikatz Execution <a href="https://attack.mitre.org/techniques/T1003/005">T1003.005</a> <a href="https://attack.mitre.org/techniques/T1003/006">T1003.004</a> <a href="https://attack.mitre.org/techniques/T1003/001">T1003.001</a> <a href="https://attack.mitre.org/techniques/T1649">T1649</a> <a href="https://attack.mitre.org/techniques/T1558/001">T1558.001</a> <a href="https://attack.mitre.org/techniques/T1558.002">T1558.002</a> <a href="https://attack.mitre.org/techniques/T1552/004">T1552.004</a> <a href="https://attack.mitre.org/techniques/T1550/002">T1550.002</a> <a href="https://attack.mitre.org/techniques/T1550/003">T1550.003</a> <a href="https://attack.mitre.org/techniques/T1555">T1555</a><a class="headerlink" href="#find-mimikatz-execution-t1003005-t1003004-t1003001-t1649-t1558001-t1558002-t1552004-t1550002-t1550003-t1555" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Get-WinEvent</code> with Sysmon Event Logs. <ul>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=10 and */EventData/Data[@Name="TargetImage"] and */EventData/Data="C:\Windows\system32\lsass.exe"'</code></li>
</ul>
</li>
<li>Use <code>DeepBlueCLI</code> (from <a href="https://github.com/sans-blue-team/DeepBlueCLI">here</a>) and Powershell. </li>
<li>View the Last Visited MRU at <code>NTUSER.dat\Software\Microsoft\Windows\CurrentVersion\Explorer\Comdlg32\LastVisited[PID]MRU</code>. </li>
<li>Examine the execution within <a href="https://www.procdot.com/downloadprocdotbinaries.htm">ProcDot</a>. </li>
</ol>
<h1 id="find-common-rat-connections-t1021">Find Common RAT Connections. <a href="https://attack.mitre.org/techniques/T1021">T1021</a><a class="headerlink" href="#find-common-rat-connections-t1021" title="Permanent link"></a></h1>
<ol>
<li>Use <code>Get-WinEvent</code> with Sysmon Event Logs. <ul>
<li>Command to use is <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=3 and */EventData/Data[@Name="DestinationPort"] and */EventData/Data=8080'</code></li>
</ul>
</li>
<li>Use <code>DeepBlueCLI</code> (from <a href="https://github.com/sans-blue-team/DeepBlueCLI">here</a>) and Powershell.</li>
</ol>
<h1 id="view-installed-programs-t1543-t1036005t1569">View Installed Programs <a href="https://attack.mitre.org/techniques/T1543">T1543</a> <a href="https://attack.mitre.org/techniques/T1036/005">T1036.005</a><a href="https://attack.mitre.org/techniques/T1569">T1569</a><a class="headerlink" href="#view-installed-programs-t1543-t1036005t1569" title="Permanent link"></a></h1>
<ol>
<li>Use <code>osquery</code> on the Windows Command line. <ul>
<li>Command to use <code>select * from programs;</code></li>
</ul>
</li>
</ol>
<h1 id="view-all-users-t1078002t1136002t1098-t1070009-t1531">View All Users <a href="https://attack.mitre.org/techniques/T1078/002">T1078.002</a><a href="/home/ajread/threat_hunting/threat_hunting_resource/%28https%3A/attack.mitre.org/techniques/T1136/002%29">T1136.002</a><a href="https://attack.mitre.org/techniques/T1098">T1098</a> <a href="https://attack.mitre.org/techniques/T1070/009">T1070.009</a> <a href="https://attack.mitre.org/techniques/T1531">T1531</a><a class="headerlink" href="#view-all-users-t1078002t1136002t1098-t1070009-t1531" title="Permanent link"></a></h1>
<ol>
<li>Use <code>osquery</code> on the Windows Command line. <ul>
<li>Command to use <code>select * from users;</code></li>
</ul>
</li>
<li>Use <code>Get-LocalUser</code> within Powershell.<ul>
<li>Command to use <code>Get-LocalUser | Where-Object 'Enabled' -eq $True</code></li>
</ul>
</li>
<li>Use <code>Get-LocalGroup</code> within Powershell.</li>
<li>Use <code>Get-LocalGroupMember</code> within Powershell with a specific group in mind.</li>
</ol>
<h1 id="determine-browser-extension-t1176">Determine Browser Extension <a href="https://attack.mitre.org/techniques/T1176">T1176</a><a class="headerlink" href="#determine-browser-extension-t1176" title="Permanent link"></a></h1>
<ol>
<li>Use <code>osquery</code> on the Windows Command line. <ul>
<li>Command to use <code>select * from ie_extensions;</code></li>
</ul>
</li>
</ol>
<h1 id="view-userassist-activity-no-ttp">View UserAssist Activity [No TTP]<a class="headerlink" href="#view-userassist-activity-no-ttp" title="Permanent link"></a></h1>
<ol>
<li>Use <code>osquery</code> on the Windows Command line. <ul>
<li>Command to use in interactive mode is <code>select sid,path from userassist;</code>. </li>
</ul>
</li>
<li>View the registry at <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{GUID}\Count</code> where the GUID is specific for the OS. </li>
</ol>
<h1 id="parse-mft-for-windows-ntfs-t1564">Parse $MFT for Windows NTFS <a href="https://attack.mitre.org/techniques/T1564">T1564</a><a class="headerlink" href="#parse-mft-for-windows-ntfs-t1564" title="Permanent link"></a></h1>
<ol>
<li>Use <code>MFTECmd.exe</code> on the Windows command line. <ul>
<li>Command to use <code>MCTECmd.exe -f [file] --csv [path_to_csv_output]</code></li>
</ul>
</li>
<li>Use <code>Autopsy</code> as a secondary tool. </li>
</ol>
<h1 id="parse-boot-for-windows-ntfs-t1564">Parse $Boot for Windows NTFS <a href="https://attack.mitre.org/techniques/T1564">T1564</a><a class="headerlink" href="#parse-boot-for-windows-ntfs-t1564" title="Permanent link"></a></h1>
<ol>
<li>Use <code>MFTECmd.exe</code> on the Windows command line. <ul>
<li>Command to use <code>MCTECmd.exe -f [file] --csv [path_to_csv_output]</code></li>
</ul>
</li>
<li>Use <code>Autopsy</code> as a secondary tool. </li>
</ol>
<h1 id="parse-j-for-windows-ntfs-t1564">Parse $J for Windows NTFS <a href="https://attack.mitre.org/techniques/T1564">T1564</a><a class="headerlink" href="#parse-j-for-windows-ntfs-t1564" title="Permanent link"></a></h1>
<ol>
<li>Use <code>MFTECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> on the Windows command line. <ul>
<li>Command to use <code>MCTECmd.exe -f [file] --csv [path_to_csv_output]</code> </li>
</ul>
</li>
<li>Use <code>Autopsy</code> as a secondary tool. </li>
</ol>
<h1 id="parse-sds-for-windows-ntfs-t1564">Parse $SDS for Windows NTFS <a href="https://attack.mitre.org/techniques/T1564">T1564</a><a class="headerlink" href="#parse-sds-for-windows-ntfs-t1564" title="Permanent link"></a></h1>
<ol>
<li>Use <code>MFTECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> on the Windows command line. <ul>
<li>Command to use <code>MCTECmd.exe -f [file] --csv [path_to_csv_output]</code></li>
</ul>
</li>
<li>Use <code>Autopsy</code> as a secondary tool. </li>
</ol>
<h1 id="parse-volume-shadow-copies-for-windows-ntfs-t1564">Parse Volume Shadow Copies for Windows NTFS <a href="https://attack.mitre.org/techniques/T1564">T1564</a><a class="headerlink" href="#parse-volume-shadow-copies-for-windows-ntfs-t1564" title="Permanent link"></a></h1>
<ol>
<li>Use <code>MFTECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> on the Windows command line. <ul>
<li>Command to use <code>MCTECmd.exe -f [file] --csv [path_to_csv_output]</code></li>
</ul>
</li>
<li>Use <code>Autopsy</code> as a secondary tool. </li>
</ol>
<h1 id="parse-logfile-for-windows-ntfs-t1564">Parse $LogFile for Windows NTFS <a href="https://attack.mitre.org/techniques/T1564">T1564</a><a class="headerlink" href="#parse-logfile-for-windows-ntfs-t1564" title="Permanent link"></a></h1>
<ol>
<li>Use <code>MFTECmd.exe</code> (from Eric Zimmerman <a href="https://ericzimmerman.github.io/#!index.md">here</a> on the Windows command line. <ul>
<li>Command to use <code>MCTECmd.exe -f [file] --csv [path_to_csv_output]</code></li>
</ul>
</li>
<li>Use <code>Autopsy</code> as a secondary tool. </li>
</ol>
<h1 id="find-service-creation-t1569002-t1543003">Find Service Creation <a href="https://attack.mitre.org/techniques/T1569/002">T1569.002</a> <a href="https://attack.mitre.org/techniques/T1543/003">T1543.003</a><a class="headerlink" href="#find-service-creation-t1569002-t1543003" title="Permanent link"></a></h1>
<ol>
<li>Use <code>DeepBlueCLI</code> (from <a href="https://github.com/sans-blue-team/DeepBlueCLI">here</a>) and Powershell. </li>
<li>Use <code>eventvwr.msc</code> with Windows System Event logs 7045. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4697. </li>
</ol>
<h1 id="view-user-authentications-t1078">View User Authentications <a href="https://attack.mitre.org/techniques/T1078/">T1078</a><a class="headerlink" href="#view-user-authentications-t1078" title="Permanent link"></a></h1>
<ol>
<li>Use <a href="https://github.com/JPCERTCC/LogonTracer">LogonTracer</a> to map out logons by users. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4624. </li>
<li>View the SAM at <code>C:\Windows\system32\config\SAM</code> or <code>SAM\Domains\Account\Users</code>. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4625 for failed logons. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4634 for logoff. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4647 for logoff. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4648 for run as login. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4672 for admin login. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4778 for RDP login. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4779 for RDP logoff. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4776 for NTLM authentication. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4768 for TGT successful logon. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4769 for TGS access to service. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4771/4772 failed ticket logon. </li>
<li>Use <code>wevutil.exe</code> and search for appropriate Windows Security Eveents logs. <ul>
<li>Command to use is <code>wevutil.exe qe Security /q:"*[System[(EventID=4624 or EventID=4625)]]</code></li>
</ul>
</li>
<li>Look for <code>gpscript.exe /logon</code> execution for user logons. </li>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4770 for kerberos ticket renewal. </li>
</ol>
<h1 id="examine-startup-actions-t1547">Examine Startup Actions <a href="https://attack.mitre.org/techniques/T1547/">T1547</a><a class="headerlink" href="#examine-startup-actions-t1547" title="Permanent link"></a></h1>
<ol>
<li>View <code>desktop.ini</code> for actions taken during startup. </li>
</ol>
<h1 id="view-hosted-web-application-exploitation-t1190">View Hosted Web Application Exploitation <a href="https://attack.mitre.org/techniques/T1190/">T1190</a><a class="headerlink" href="#view-hosted-web-application-exploitation-t1190" title="Permanent link"></a></h1>
<ol>
<li>Use <code>eventvwr.msc</code> with Windows Security Event logs 4688 for process creation events on the host. </li>
<li>View suspicious php or .jsp files within <code>/var/log/httpd/access.log</code>. </li>
</ol>
<h1 id="identify-phishing-attempts-t1566">Identify Phishing Attempts <a href="https://attack.mitre.org/techniques/T1566/">T1566</a><a class="headerlink" href="#identify-phishing-attempts-t1566" title="Permanent link"></a></h1>
<ol>
<li>Look for registry modifications to <code>HKLM\SYSTEM\CurrentControlSet\Services\&lt;NetworkProviderName&gt;\NetworkProvider</code>, <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\
Notification Packages</code>, or <code>HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order</code>. </li>
</ol>
<h1 id="identity-suspicious-dlls-t1574">Identity Suspicious DLLs <a href="https://attack.mitre.org/techniques/T1574/">T1574</a><a class="headerlink" href="#identity-suspicious-dlls-t1574" title="Permanent link"></a></h1>
<ol>
<li>Examine changes in DLLs residing in <code>C:\Windows\System32</code>. </li>
</ol></article></body></html>